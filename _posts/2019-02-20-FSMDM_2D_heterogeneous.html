---
title: Simulation in the 2D heterogeneous media using the frequency-specific mixed domain method
---
<p>
<br>
<hr>
<hr>
 This example shows how to simulate the second-harmonic wave field in the heterogeneous 
  media using the frequency-specific mixed domain method.
<hr>
<hr>
</p>

<!---2D heterogeneous medium--->
<h6>Define the 2D heterogeneous media</h6>
<hr>
<br>
<p>
 Details of defining the computational domain and the phased-array transducer are shown in the case
<a href="https://m-sound.github.io/mSOUND/FSMDM_2D_homogeneous">
 Simulation in a 2D homogeneous medium using the frequency-specific mixed domain method</a>.   
In this heterogeneous media, density, speed of sound, nonlinear coefficient and attenuation coefficients are all
  spatially varying functions. In this example, media properties are the same as that defined in 
  <a href="https://m-sound.github.io/mSOUND/TMDM_2D_heterogeneous">
   Simulation in the 2D heterogeneous media using the transient mixed domain method</a>.
 </p>


<!---2D forward Simulation--->
<h6>2D forward simulation</h6>
<hr>
<p>
The fundamental pressure field is first calculated with the 2D forward simulation function
 <a href="/mSOUND/function.html#Forward2D_fund">Forward2D_fund</a>, 
and the pressure at the second-harmonic frequency is then calculated with the function <a href="/mSOUND/function.html#Forward2D_sec">Forward2D_sec</a>. 
 <pre>
<code>
p_fundamental = Forward2D_fund(mgrid, medium, source_p); 
p_second = Forward2D_sec(mgrid, medium, p_fundamental, omega_c); 
</code>
</pre>
<br> The left figure below the spatial distribution of the fundamental pressure and
the right one ws the second-harmonic pressure.

   <img src="/mSOUND/img/FSMDM_hete_2D.jpg" alt="fundamental and the second-harmonic pressure field">
 </p>

<h6>Other examples</h6>
<hr>
<p>
<br><h7 style='font-weight:bold;'>&#8594;TMDM</h7>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_2D_homogeneous">
    Simulation in a 2D homogeneous medium using the transient mixed domain method</a>
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_2D_homogeneous">
    Simulation in a 2D homogeneous medium using the transient mixed domain method</a>
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_2D_heterogeneous">
    Simulation in the 2D heterogeneous media using the transient mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_3D_homogeneous">
    Simulation in a 3D homogeneous medium using the transient mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_2D_homogeneous">
    Simulation in a 2D homogeneous medium using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/combine-k-Wave-TMDM">
    Implementation of k-Wave for arbitrary shape transducer</a> 
<br><h7 style='font-weight:bold;'>&#8594;FSMDM</h7>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_2D_heterogeneous">
    Simulation in the 2D heterogeneous media using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_3D_homogeneous">
    Simulation in a 3D homogeneous medium using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM-3D_heterogeneous">
    Simulation in the 3D heterogeneous media using the frequency-specific mixed domain method</a>
</p>


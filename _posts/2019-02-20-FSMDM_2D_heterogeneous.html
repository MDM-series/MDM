---
title: Simulation in the 2D heterogeneous media using the frequency-specific mixed domain method
---
<p>
<br>
<hr>
<hr>
 This example shows how to simulate the second-harmonic wave field in the heterogeneous 
  media using the frequency-specific mixed domain method.
<hr>
<hr>
</p>

<!---2D heterogeneous medium--->
<h6>Defining the 2D heterogeneous media</h6>
<hr>
<br>
<p>
 Details of defining the computational domain and the phased-array transducer are shown in the case
<a href="https://m-sound.github.io/mSOUND/FSMDM_2D_homogeneous">
 Simulation in a 2D homogeneous medium using the frequency-specific mixed domain method</a>.  
In this heterogeneous media, density, speed of sound, nonlinear coefficient and attenuation coefficients are all
  spatially varying functions. In this example, media properties are the same as that defined in 
  <a href="https://m-sound.github.io/mSOUND/TMDM_2D_heterogeneous">
   Simulation in the 2D heterogeneous media using the transient mixed domain method</a>. But the density 
 is set homogeneously in this case because in the current version, the function
 <a href="/mSOUND/function.html#Forward2D_sec">Forward2D_sec</a> assumes a homogeneous density distribution.
 </p>


<!---2D forward Simulation--->
<h6>2D forward simulation</h6>
<hr>
<p>
The fundamental pressure field is first calculated with the 2D forward simulation function
 <a href="/mSOUND/function.html#Forward2D_fund">Forward2D_fund</a>, 
and the pressure at the second-harmonic frequency is then calculated with the function
 <a href="/mSOUND/function.html#Forward2D_sec">Forward2D_sec</a>. The first and the seconc-order reflections
 are included in the fundamental pressure simulation.
 <pre>
<code>
<font color="#03a852">% the maximum order of reflection included in the simulation </font>   
reflection_order = 2;

medium.absorb_gamma = 0.5;  <font color="#03a852">% constant for absorption layer</font> 
medium.absorb_alpha = 0.1;  <font color="#03a852">% decay factor for absorption layer</font> 

<font color="#03a852">% forward propagation of the fundamental pressure</font>   
P_fundamental = Forward2D_fund(mgrid, medium, excit_p, omegac,...
                reflection_order, 'absorption');

<font color="#03a852">% forward propagation of the second-harmonic pressure  </font>   
P_second = Forward2D_sec(mgrid, medium, P_fundamental, omegac, 'absorption');
</code>
</pre>
<br> The left figure below shows the spatial distribution of the fundamental pressure and
the right one was the second-harmonic pressure.

   <img src="/mSOUND/img/FSMDM_2D_heterogeneous.jpg" alt="fundamental and the second-harmonic pressure field">
 </p>

<h6>Other examples</h6>
<hr>
<p>
<br><h7 style='font-weight:bold;'>&#11166;Forward TMDM</h7>
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_2D_homogeneous">
    Simulation in a 2D homogeneous medium using the transient mixed domain method</a>
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_2D_heterogeneous">
    Simulation in the 2D heterogeneous media using the transient mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_3D_homogeneous">
    Simulation in a 3D homogeneous medium using the transient mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/combine-k-Wave-TMDM">
    Implementation of k-Wave for arbitrary shape transducer</a> 
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM-2D-strong-speed-of-sound-contrast">
    Simulation in the 2D heterogeneous media with strong speed of sound contrast using the transient mixed domain method</a> 
<br>&middot;<a href="https://m-sound.github.io/mSOUND/Backward_TMDM">
    Imaging reconstruction using the TMDM backward projection</a>   
 
<br><h7 style='font-weight:bold;'>&#11166;Forward FSMDM</h7>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_2D_homogeneous">
    Simulation in a 2D homogeneous medium using the frequency-specific mixed domain method</a> 
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_2D_heterogeneous">
    Simulation in the 2D heterogeneous media using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_3D_homogeneous">
    Simulation in a 3D homogeneous medium using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM-3D_heterogeneous">
    Simulation in the 3D heterogeneous media using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/2D_absorption">
    Add absorption layer to the FSMDM</a> 
</p>


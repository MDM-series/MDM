---
title: Simuation in the 2D heterogeneous media using the transient mixed domain method
---
<p>
<br>
<hr>
<hr>
This example provides the demenstration of using the transiment mixed domain method for simulating wave propagation in 2D heterogeneous media. 
 This example is based on the simulation case 
  <a href="https://m-sound.github.io/mSOUND/generate_2D_focused_ultrasound_beam_with_phased_array">generate the 2D focused ultrasound beam with a phased array</a>.
 Definition of the omputational domain and transducer setting are the same in the two examples.
<hr>
<hr>
</p>

<!---Define the media--->
<h6>Define the media</h6>
<p>
 <br>
 Speed of sound, density, nonlinear coefficient, attenuation coefficient and power law exponent can all be spatially varying functions. 
 The 2D tissue model used in this case is shown in the figure below. 
 <code>
  <br>   
  <br>medium.c    = c;         <font color="#03a852">% speed of sound [m/s]</font>      
  <br>medium.rho  = rho;       <font color="#03a852">% density [kg/m^3]</font>             
  <br>medium.beta = beta;      <font color="#03a852">% nonlinear coefficient </font>    
  <br>medium.ca   = ca;        <font color="#03a852">% attenuation coefficient [dB/(MHz^y cm)] </font>    
  <br>medium.cb   = cb;        <font color="#03a852">% power law exponent</font>    
 </code>
  <br>
  <br>
 <img src="/mSOUND/img/img_pattern.PNG" alt="2D tissue model">
 </p>


<!---2D forward Simulation--->
<h6>2D forward simulation</h6>
<p>
 Transient pressure field results are calculated with the 2D forward simulation function <a href="/mSOUND/functions">Forward2D</a>.
<code>
  <br>
<br> p_total = Forward2D(mgrid, medium, source_p); 
  <br>
 </code>
 </p>

<p>
<br>
  <img src="/mSOUND/img/cylinders_field.PNG" alt="fundamental and the second-harmonic pressure field">
 
 </p>





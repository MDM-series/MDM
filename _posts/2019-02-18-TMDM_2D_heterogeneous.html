---
title: Simulation of a 2D heterogeneous medium using the transient mixed domain method
---
<p>
<br>
<hr>
<hr>
This example provides the demenstration of using the transient mixed domain method for simulating wave propagation 
in 2D heterogeneous media. 
<hr>
<hr>
</p>

<!---Defining the media--->
<h6>Defining the medium properties</h6>
<p>
<br>
Definition of the computational domain and transducer settings in this are similar to the case 
<a href="https://m-sound.github.io/mSOUND/TMDM_2D_homogeneous">Simulation in a 
2D homogeneous medium using the transient mixed domain method</a>.
In this example, speed of sound, density, nonlinear coefficient, attenuation coefficient and power law exponent are 
all spatially varying functions. One thing to be careful is that medium.c0 is defined as the minimum value in the medium.c.
The 2D tissue model used in this case is shown in the figure below. 
 <pre>
 <code>
p0 = 2.0e6;   <font color="#03a852"> % source pressure magnitude [Pa]</font>  
fc = 1.0e6;   <font color="#03a852"> % fundamental frequency [Hz]</font>  
TR_focus  = 0.0210;   <font color="#03a852"> % transducer focus length [m]</font>         
TR_radius = 0.0112;   <font color="#03a852"> % Transducer diameter [m]</font> 

load tissue_model.mat   <font color="#03a852">% load the tissue model data</font>   
medium.c    = c;        <font color="#03a852">% speed of sound [m/s]</font>      
medium.rho  = rho;      <font color="#03a852">% density [kg/m^3]</font>             
medium.beta = beta;     <font color="#03a852">% nonlinear coefficient </font>    
medium.ca   = ca;       <font color="#03a852">% attenuation coefficient [dB/(MHz^y cm)] </font>    
medium.cb   = cb;       <font color="#03a852">% power law exponent</font> 
medium.c0 = min(min(c));  <font color="#03a852">% reference speed of sound [m/s]</font> 
</code>
</pre>
<img src="/mSOUND/img/tissue_model.jpg" alt="2D tissue model">
</p>


<!---2D forward Simulation--->
<h6>2D forward simulation</h6>
<p>
Transient pressure fields are calculated with the 2D forward simulation function <a href="/mSOUND/function.html#Forward2D">Forward2D</a>.
<pre><code>
<font color="#03a852">% define where the pressure will be recorded</font>  
sensor_mask = zeros(mgrid.num_x, mgrid.num_y+1);
sensor_mask(100:300, 2:end) = 1;

<font color="#03a852">% the maximum order of reflection included in the simulation</font>  
reflection_order = 2; 

<font color="#03a852">% 2D forward simulation</font>  
p_total = Forward2D(mgrid, medium, source_p, sensor_mask, reflection_order); 
</code>
</pre>
</p>

<p>
<img src="/mSOUND/img/TMDM_2D_heterogeneous.jpg" alt="fundamental and the second-harmonic pressure field">
</p>

<h6>Other examples</h6>
<hr>
<p>
<br><h7 style='font-weight:bold;'>&#11166;Forward TMDM</h7>
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_2D_homogeneous">
    Simulation in a 2D homogeneous medium using the transient mixed domain method</a>
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_2D_heterogeneous">
    Simulation in the 2D heterogeneous media using the transient mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_3D_homogeneous">
    Simulation in a 3D homogeneous medium using the transient mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/combine-k-Wave-TMDM">
    Implementation of k-Wave for arbitrary shape transducer</a> 
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM-2D-strong-speed-of-sound-contrast">
    Simulation in the 2D heterogeneous media with strong speed of sound contrast using the transient mixed domain method</a>  
<br>&middot;<a href="https://m-sound.github.io/mSOUND/Backward_TMDM">
    Imaging reconstruction using the TMDM backward projection</a>   
 
<br><h7 style='font-weight:bold;'>&#11166;Forward FSMDM</h7>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_2D_homogeneous">
    Simulation in a 2D homogeneous medium using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_2D_heterogeneous">
    Simulation in the 2D heterogeneous media using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_3D_homogeneous">
    Simulation in a 3D homogeneous medium using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM-3D_heterogeneous">
    Simulation in the 3D heterogeneous media using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/2D_absorption">
    Add absorption layer to the FSMDM</a>
</p>


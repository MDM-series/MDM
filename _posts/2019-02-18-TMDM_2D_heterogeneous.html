---
title: Simulation in the 2D heterogeneous media using the transient mixed domain method
---
<p>
<br>
<hr>
<hr>
This example provides the demenstration of using the transiment mixed domain method for simulating wave propagation in 2D heterogeneous media. 
<hr>
<hr>
</p>

<!---Define the media--->
<h6>Define the media</h6>
<p>
 <br>
  This example is based on the simulation case 
  <a href="https://m-sound.github.io/mSOUND/TMDM_2D_homogeneous">Simulation in a 2D homogeneous medium using the transient mixed domain method</a>.
 Definition of the computational domain and transducer setting are the same in the two examples.
 In this example, speed of sound, density, nonlinear coefficient, attenuation coefficient and power law exponent are 
 all spatially varying functions. 
 The 2D tissue model used in this case is shown in the figure below. 
 <code>
  <br>   
  <br> load tissue_model.mat;   <font color="#03a852">% load the tissue properties</font>      
  <br>medium.c    = c;         <font color="#03a852">% speed of sound [m/s]</font>      
  <br>medium.rho  = rho;       <font color="#03a852">% density [kg/m^3]</font>             
  <br>medium.beta = beta;      <font color="#03a852">% nonlinear coefficient </font>    
  <br>medium.ca   = ca;        <font color="#03a852">% attenuation coefficient [dB/(MHz^y cm)] </font>    
  <br>medium.cb   = cb;        <font color="#03a852">% power law exponent</font>    
 </code>
  <br>
  <br>
 <img src="/mSOUND/img/img_pattern.PNG" alt="2D tissue model">
 </p>


<!---2D forward Simulation--->
<h6>2D forward simulation</h6>
<p>
 Transient pressure field results are calculated with the 2D forward simulation function <a href="/mSOUND/functions">Forward2D</a>.
<code>
  <br>
 <br> sensor_mask = ones(mgrid.num_x, mgrid.num_y); <font color="#03a852">% define where the pressure will be recorded</font>    
<br> p_total = Forward2D(mgrid, medium, source_p, sensor_mask); 
  <br>
 </code>
 </p>

<p>
<br>
  <img src="/mSOUND/img/cylinders_field.PNG" alt="fundamental and the second-harmonic pressure field">
 
 </p>





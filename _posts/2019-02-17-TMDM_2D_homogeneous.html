---
title: Simulation in a 2D homogeneous medium using the transient mixed domain method
---
<p>
<br>
<hr>
<hr>
 This example shows how to simulate the wave propagation in a 2D 
 homogeneous medium with the transient mixed domain method. The focused beam is generated with a phased-array.
<hr>
<hr>
</p>

<!---define the structure grid--->
<h6>Generate the grid structure in the computational domain</h6>
<hr>
<p>
 <br>We first need to define the temporal and spatial computational domain in 2D forward simulations 
 with the funciton <a href="/mSOUND/functions#L73">set_grid</a>. For 2D problems,
 six inputs are required to to call this function. Coordinates defined within the mgrid structure are all in the Cartesian coordinates.
 <br>
 <code>        
<br>dx = 3.75e-04;         <font color="#03a852"> %  step size in the x direction [m]</font> 
<br>dy = 3.75e-04;         <font color="#03a852"> %  step size in the y direction [m]</font> 
<br>dt = 6.25e-08;         <font color="#03a852"> %  time step size [s]</font> 

<br>x_length = 0.0454;         <font color="#03a852"> % total computatoinal domain size in x direction [m]</font> 
<br>y_length = 0.0240;         <font color="#03a852"> % total computatoinal domain size in y direction [m]</font> 
<br>t_length = 3.20e-05;       <font color="#03a852"> % total temporal domain size [s]</font> 
<br>mgrid = set_grid(dt, t_length, dx, x_length, dy, y_length);              
</code>   
 <br>
</p>


<!---define the phased array transducer--->
<h6>Define the phased array transducer</h6>
<hr>
<p>
 In this example, phased array transducer is used to generate the foucsed ultrasound beam. 
<code>
<br>
 <br> fc = 1.0e6; <font color="#03a852"> % fundamental frequency [Hz]</font>   
<br>TR_focus  = 0.0150;      <font color="#03a852"> % transducer focus length [m]</font>         
<br>TR_radius = 0.0075;      <font color="#03a852"> % Transducer diameter [m]</font>   
<br>delay = sqrt((mgrid.x).^2 + TR_focus^2)/medium.c0; <font color="#03a852"> % calculate the delay for each element [m]</font>   
<br> delay = delay - min(delay);
<br>TR_mask = ones(mgrid.num_x,1);<font color="#03a852"> % define the transducer mask</font>  
<br>TR_mask(abs(mgrid.x)>TR_radius,:) = 0; <font color="#03a852"> % a 2D phased array</font>  
<br> 
</code>
 </p>

<!---Excitation signal--->
<h6>Excitation signal</h6>
<hr>
<p>
A four-cycles Gaussian-modulated pulse is used for the excitation signal. The pulse is illustrated in the figure below.  
 <br>
<code>

<br>num_cycles = 4;<font color="#03a852"> % number of cycles over which to define the pulse</font>  
<br>ts = [-num_cycles/fc:dt:num_cycles/fc].';<font color="#03a852"> % define the pulse length [s]</font>  
 <br>ts_length = length(ts);
<br>delay = repmat(delay, ts_length,1);    
<br>ts = repmat(ts, 1,mgrid.num_x);     
<br>source_p = p0*sin(2*pi*fc*(ts+delay)).*exp(-(ts+delay).^2*fc^2/2); <font color="#03a852"> % define the pulse </font>  
<br>source_p = source_p.*repmat(TR_mask.', ts_length,1); <font color="#03a852"> % apply the transducer mask </font>  
<br>
</code>
 <br>
  <img src="/mSOUND/img/Gaussian_pulse.jpg" alt="Guassian modulated pulse">
 </p>

<!---Define the medium--->
<h6>Define the medium</h6>
<hr>
<p>
Define the homogeneous medium. When dispersion is not considered, power law exponent is set to 2.0.
 <code>
  <br>   
  <br>medium.c    = 1500;       <font color="#03a852">% speed of sound [m/s]</font>      
  <br>medium.rho  = 1000;       <font color="#03a852">% density [kg/m^3]</font>             
  <br>medium.beta = 0;          <font color="#03a852">% nonlinear coefficient </font>    
  <br>medium.ca   = 0;          <font color="#03a852">% attenuation coefficient [dB/(MHz^y cm)] </font>    
  <br>medium.cb   = 2.0;        <font color="#03a852">% power law exponent</font>    
 </code>
 </p>

<!---2D forward Simulation--->
<h6>2D forward simulation</h6>
<hr>
<p>
 Transient pressure is calculated with the 2D forward simulation function <a href="/mSOUND/functions">Forward2D</a>. 
 Time domain result recorded at the transducer focal point and spatially distributed fundamental pressure are shown below.
<code>
  <br>
 <br>sensor_mask = zeros(mgrid.num_x, mgrid.num_y);
 <br> sensor_mask(30:90,:) = 1;  <font color="#03a852">% define where the pressure will be recorded</font>    
<br> p = Forward2D(mgrid, medium, source_p, sensor_mask); 
  <br>
 </code>
 <br>
   <img src="/mSOUND/img/TMDM_2D_homogeneous.jpg" alt="(a) Time-domain singal recorded at the transducer focus
                                                       (b) Fundamental pressure distribution through the sensor mask">
 </p>

 

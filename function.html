---
layout: default
---
 
<h2>Functions</h2> 
<hr>  
<hr> 

<a id="set_grid"></a>  

<h3 style="color: #c64949;"> set_grid </h3>         
<hr>   
<p>
set_grid is the grid class used across the mSOUND Toolbox and it can generate a structure containing the Cartesian grid coordinates, 	
evenly spaced time array and wavenumber matrices used within the simulation in mSOUND.

<pre> <code>
mgrid = set_grid(dt, t_length, dx, x_length);                         
mgrid = set_grid(dt, t_length, dx, x_length, dy, y_length);     
mgrid = set_grid(dt, t_length, dx, x_length, dy, y_length, dz, z_length);     
</code> </pre>
</p>

<h3>Inputs </h3> 
<table>
  <tr>
    <th>INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>dx</td><td>spatial step size in the x direction [m]</td>
  </tr>
  <tr>
    <td>dy</td><td>spatial step size in the y direction [m]</td>
  </tr>
  <tr>
    <td>dz</td><td>spatial step size in the z direction [m]</td>
  </tr>
  <tr>
    <td>dt</td><td>temporal step size [s]</td>
  </tr>
  <tr>
    <td>x_length</td><td>total domain size in the x direction [m]</td>
  </tr>  
  <tr>
    <td>y_length</td><td>total domain size in the y direction [m]</td>
  </tr>    
  <tr>
    <td>z_length</td><td>total domain size in the z direction [m]</td>
  </tr>      
  <tr>
    <td>t_length</td><td>total temporal domain size [s]</td>
  </tr> 
 </table> 

<br>       

<h3>Outputs</h3> 
<table>
  <tr>
    <th>OUTPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>mgrid.x</td><td>coordinates in the x direction [m] </td>
  </tr>
  <tr>
    <td>mgrid.y</td><td>coordinates in the y direction [m] </td>
  </tr>
  <tr>
    <td>mgrid.z</td><td>coordinates in the z direction [m] </td>
  </tr>
  <tr>
    <td>mgrid.t</td><td>evenly spaced time array [s]</td>
  </tr>
  <tr>
    <td>mgrid.kx</td><td>wavevector in the x direction</td>
  </tr>  
  <tr>
    <td>mgrid.ky</td><td>wavevector in the y direction</td>
  </tr>    
  <tr>
    <td>mgrid.w</td><td>angular frequency</td>
  </tr>      
  <tr>
    <td>mgrid.num_x</td><td>number of grid points in the x direction</td>
  </tr> 
  <tr>
    <td>mgrid.num_y</td><td>number of grid points in the y direction</td>
  </tr> 
  <tr>
    <td>mgrid.num_z</td><td>number of grid points in the z direction</td>
  </tr> 
  <tr>
    <td>mgrid.num_t</td><td>number of time steps</td>
  </tr>
 </table> 
<br>

<a id="Forward1D"></a>
<h3 style="color: #c64949;">Forward1D </h3>   

<hr>
<p>
Simulation of the 1D wave propagation which is based on the transient mixed domain method. Generally, 
 for simulations with soft tissue or strong heterogeneous media with small speed of sound contrast 
 (contrast ratio less than 1.10), it is unnecessary to apply corrections.  
<pre> <code>
p = Forward1D(mgrid, medium, source_p, sensor_mask);  
p = Forward1D(mgrid, medium, source_p, sensor_mask, ...);  
</code>  </pre>
</p>

<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
   <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the pressure is recorded</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong speed of sound contrast</td>
  </tr>
 </table> 


<br>
<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by sensor_mask.
 </pr>


<a id="Forward2D"></a>
<h3 style="color: #c64949;">Forward2D  </h3>   
<hr>
<p>
Simulation of the 2D wave propagation which is based on the transient mixed domain method. Generally, 
 for simulations with soft tissue or strong heterogeneous media with small speed of sound contrast 
 (contrast ratio less than 1.10), it is unnecessary to apply corrections.         
<pre>  <code>
p = Forward2D(mgrid, medium, source_p, sensor_mask); 
p = Forward2D(mgrid, medium, source_p, sensor_mask, ...); 
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
   <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the pressure is recorded</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong speed of sound contrast</td>
  </tr>
 </table> 
<br>
<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by sensor_mask.
 </pr>


<a id="Forward3D"></a>
<h3 style="color: #c64949;">Forward3D</h3>     
<hr>
<p>
Simulation of the 3D wave propagation which is based on the transient mixed domain method. Generally, 
 for simulations with soft tissue or strong heterogeneous media with small speed of sound contrast 
 (contrast ratio less than 1.10), it is unnecessary to apply corrections.                
<pre>  <code>
p = Forward3D(mgrid, medium,source_p, sensor_mask);
p = Forward3D(mgrid, medium,source_p, sensor_mask, ...);
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr> 
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the pressure is recorded</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong speed of sound contrast</td>
  </tr>
 </table> 
<br>  
<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by sensor_mask.
 </pr>


<a id="Forward2D_fund"></a>
<h3 style="color: #c64949;">Forward2D_fund</h3>     
<hr>
<p>
Simulation of the 2D wave propagation at the fundamental frequency which is 
based on the frequency-specific mixed domain method. Generally, 
 for simulations with soft tissue or strong heterogeneous media with small speed of sound contrast 
 (contrast ratio less than 1.10), it is unnecessary to apply corrections.                
<pre>  <code>
p = Forward2D_fund(mgrid, medium, source_p, omega_c);  
p = Forward2D_fund(mgrid, medium, source_p, omega_c, ...);  
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>fundamental frequency </td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong speed of sound contrast</td>
  </tr>
 </table> 

<br>  
<h3>Outputs</h3> 
<p>
Pressure distribution throughout the spatial domain at the fundamental frequency.      
</pr>


<a id="Forward2D_sec"></a>

<h3 style="color: #c64949;">Forward2D_sec</h3>    
<hr>
<p>
Simulation of the 2D wave propagation at the second-harmonic frequency which is based on the frequency-specific mixed domain method. 
 To generate the second harmonic pressure field, we usually need to 
 generate the pressure field at the fundamental pressure first with the function <a href="/mSOUND/function.html#Forward2D_fund">Forward2D_fund</a>. 
 When calculate the second harmonic pressure, density heterogeneity is not considered. 
 Generally, for simulations with soft tissue or strong heterogeneous media with small speed of sound contrast 
 (contrast ratio less than 1.10), it is unnecessary to apply corrections.        
<pre>  <code>
p = Forward2D_sec(mgrid, medium, P_fundamental, omega_c);  
p = Forward2D_sec(mgrid, medium, P_fundamental, omega_c, ...);  
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>P_fundamental</td><td>pressure at the fundamental frequency  [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>fundamental frequency </td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong speed of sound contrast</td>
  </tr>
 </table> 
<br>  
<h3>Outputs</h3> 
<p>
Pressure distribution throughout the spatial domain at the second-harmonic frequency.    
</pr>


<a id="Forward3D_fund"></a>
<h3 style="color: #c64949;">Forward3D_fund</h3>   
<hr>
<p>
Simulation of the 3D wave propagation at the fundamental frequency which
 is based on the frequency-specific mixed domain method. Generally, 
 for simulations with soft tissue or strong heterogeneous media with small speed of sound contrast 
 (contrast ratio less than 1.10), it is unnecessary to apply corrections.       
<pre>  <code>
p = Forward3D_fund(mgrid, medium,  source_p, omega_c);  
p = Forward3D_fund(mgrid, medium,  source_p, omega_c, ...);  
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>fundamental frequency </td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong speed of sound contrast</td>
  </tr>
 </table> 
<br>  
<h3>Outputs</h3> 

<p>
Pressure distribution throughout the spatial domain at the fundamental frequency.    
</pr>


<a id="Forward3D_sec"></a>
<h3 style="color: #c64949;">Forward3D_sec</h3>   
<hr>
<p>
Simulation of the 3D wave propagation at the second-harmonic frequency which is based on the frequency-specific mixed domain method.
To generate the second harmonic pressure field, we usually need to generate the pressure field at the fundamental frequency first 
 with the function <a href="/mSOUND/function.html#Forward3D_fund">Forward3D_fund</a>.
 When calculate the second harmonic pressure, density heterogeneity is not considered. 
 Generally, for simulations with soft tissue or strong heterogeneous media with small speed of sound contrast 
 (contrast ratio less than 1.10), it is unnecessary to apply corrections.      
<pre>  <code>
p = Forward3D_sec(mgrid, medium, P_fundamental, omega_c);   
p = Forward3D_sec(mgrid, medium, P_fundamental, omega_c, ...);   
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>P_fundamental</td><td>pressure at the fundamental frequency  [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>fundamental frequency </td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong speed of sound contrast</td>
  </tr>
 </table> 
<br>  
<h3>Outputs</h3> 
<p>
Pressure distribution throughout the spatial domain at the second-harmonic frequency.    
</pr>








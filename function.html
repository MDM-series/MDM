---
layout: default
---
 
<h2>Functions</h2> 
<hr>  
<hr> <p>
<br><h7 style='font-weight:bold;'>&#11166;Functions for defining the computational domain</h7>
<br> <a href="/mSOUND/function.html#set_grid">set_grid</a>
 <br>
<br><h7 style='font-weight:bold;'>&#11166;Functions for forward projection</h7>
<br> <a href="/mSOUND/function.html#Forward1D">Forward1D</a>
<br> <a href="/mSOUND/function.html#Forward2D">Forward2D</a>
<br> <a href="/mSOUND/function.html#Forward3D">Forward3D</a> 
<br> <a href="/mSOUND/function.html#Forward2D_fund">Forward2D_fund</a>
<br> <a href="/mSOUND/function.html#Forward2D_sec">Forward2D_sec</a> 
<br> <a href="/mSOUND/function.html#Forward3D_fund">Forward3D_fund</a>
<br> <a href="/mSOUND/function.html#Forward3D_sec">Forward3D_sec</a> 
<br>
<br><h7 style='font-weight:bold;'>&#11166;Functions for backward projection</h7>
<br> <a href="/mSOUND/function.html#Backward1D">Backward1D</a>
<br> <a href="/mSOUND/function.html#Backward2D">Backward2D</a>
<br> <a href="/mSOUND/function.html#Backward3D">Backward3D</a> 
<br> <a href="/mSOUND/function.html#Backward2D_fund">Backward2D_fund</a>
<br> <a href="/mSOUND/function.html#Backward3D_fund">Backward3D_fund</a>
</p>

<hr>
<hr>
<a id="set_grid"></a>  

<h3 style="color: #c64949;">set_grid </h3>         
<hr>   
<p>
<a href="/mSOUND/function.html#set_grid">set_grid</a>
 is the grid class used across the mSOUND Toolbox and it can generate a structure containing the Cartesian grid coordinates, 	
evenly spaced time array and wavenumber matrices used within the simulation in mSOUND.

<pre> <code>
mgrid = set_grid(dt, t_length, dx, x_length);                         
mgrid = set_grid(dt, t_length, dx, x_length, dy, y_length);     
mgrid = set_grid(dt, t_length, dx, x_length, dy, y_length, dz, z_length);     
</code> </pre>
</p>

<h3>Inputs </h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>dx</td><td>spatial step size in the x direction [m]</td>
  </tr>
  <tr>
    <td>dy</td><td>spatial step size in the y direction [m]</td>
  </tr>
  <tr>
    <td>dz</td><td>spatial step size in the z direction [m]</td>
  </tr>
  <tr>
    <td>dt</td><td>temporal step size [s]</td>
  </tr>
  <tr>
    <td>x_length</td><td>total domain size in the x direction [m]</td>
  </tr>  
  <tr>
    <td>y_length</td><td>total domain size in the y direction [m]</td>
  </tr>    
  <tr>
    <td>z_length</td><td>total domain size in the z direction [m]</td>
  </tr>      
  <tr>
    <td>t_length</td><td>total temporal domain size [s]</td>
  </tr> 
 </table> 

<br>       

<h3>Outputs</h3> 
<table>
  <tr>
    <th>OUTPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid.x</td><td>coordinates in the x direction [m] </td>
  </tr>
  <tr>
    <td>mgrid.y</td><td>coordinates in the y direction [m] </td>
  </tr>
  <tr>
    <td>mgrid.z</td><td>coordinates in the z direction [m] </td>
  </tr>
  <tr>
    <td>mgrid.t</td><td>evenly spaced time array [s]</td>
  </tr>
  <tr>
    <td>mgrid.kx</td><td>wavevector in the x direction</td>
  </tr>  
  <tr>
    <td>mgrid.ky</td><td>wavevector in the y direction</td>
  </tr>    
  <tr>
    <td>mgrid.w</td><td>angular frequency</td>
  </tr>      
  <tr>
    <td>mgrid.num_x</td><td>number of grid points in the x direction</td>
  </tr> 
  <tr>
    <td>mgrid.num_y</td><td>number of grid points in the y direction</td>
  </tr> 
  <tr>
    <td>mgrid.num_z</td><td>number of grid points in the z direction</td>
  </tr> 
  <tr>
    <td>mgrid.num_t</td><td>number of time steps</td>
  </tr>
 </table> 
<br>

<a id="Forward1D"></a>
<h3 style="color: #c64949;">Forward1D </h3>   

<hr>
<p>
 <a href="/mSOUND/function.html#Forward1D">Forward1D</a>
 is a 1D forward simulation function based on the transient mixed domain method and it will generate transient-domain results.
<pre> <code>
p = Forward1D(mgrid, medium, source_p, sensor_mask, reflection_order);  
p = Forward1D(mgrid, medium, source_p, sensor_mask, reflection_order, ...);  
</code>  </pre>
</p>

<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
   <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the pressure is recorded</td>
  </tr>
  <tr>
   <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr> 
 </table> 
<br>
<table>
  <tr>
   <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
   <td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
  </tr>
 </table> 

<br> 
<h3> Details </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 1D simulations, the medium properties should be given as matrices with a size (mgrid.num_x+1, 1).
 For homogeneous media, though, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 <br><br>2. The excitation pressure <span style="background-color:#f1f1f1">source_p</span> is indexed as (time, source_position). 
 <br><br>3. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x+1, 1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 <br><br>4. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflections to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 <br><br>5. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
</p>


<br>
<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>


<a id="Forward2D"></a>
<h3 style="color: #c64949;">Forward2D  </h3>   
<hr>
<p>
 <a href="/mSOUND/function.html#Forward2D">Forward2D</a>
 is a 2D forward simulation function based on the transient mixed domain method and it will generate transient-domain results.
 
<pre>  <code>
p = Forward2D(mgrid, medium, source_p, sensor_mask, reflection_order); 
p = Forward2D(mgrid, medium, source_p, sensor_mask, reflection_order, ...); 
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
   <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the pressure is recorded</td>
  </tr>
   <tr>
   <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr> 
 </table> 
<br>
<table>
  <tr>
  <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
  <td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply non-reflecting layerr</td>
  </tr>
  <tr>
  <td>'animation'</td><td>play the animation during the simulation</td>
  </tr>
  <tr>
  <td>'record_animation'</td><td>record the animation</td>
  </tr> 
 </table> 

<br> 
<h3> Details </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 1D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y+1).
 For homogeneous media, though, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 <br><br>2. The excitation pressure <span style="background-color:#f1f1f1">source_p</span> is indexed as (time, source_position). 
 <br><br>3. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x, mgrid.num_y+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 <br><br>4. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflections to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 <br><br>5. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 <br><br>6. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. A large <span style="background-color:#f1f1f1">medium.NRL_gamma</span> 
 or a small <span style="background-color:#f1f1f1">medium.NRL_alpha</span> implies more energy will be absorbed and 
 thus reducing the aliasing error. On the contrary, if <span style="background-color:#f1f1f1">medium.NRL_alpha</span> is too small, 
 the acoustic filed becomes inaccurate due to excess absorption. 
 <br><br>7. <span style="background-color:#f1f1f1">record_animation</span> will record the animation and save the animation 
 file as ‘animation.avi’.
</p>

<br>
<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>


<a id="Forward3D"></a>
<h3 style="color: #c64949;">Forward3D</h3>     
<hr>
<p>
 <a href="/mSOUND/function.html#Forward3D">Forward3D</a>
 is a 3D forward simulation function based on the transient mixed domain method and it will generate transient-domain results. 
 Generally, for simulations with small speed of sound or density contrast (contrast ratio less than 1.05), 
 it is unnecessary to apply corrections. The spatial aliasing error can be reduced by increasing the computational domain or applying
 the non-reflecting layer to the computational domain. To apply non-reflecting layer to the computational domain, two parameters 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be provided. Setting up a larger <span style="background-color:#f1f1f1">medium.NRL_gamma</span> or
smaller <span style="background-color:#f1f1f1">medium.NRL_alpha</span> 
 means more energy will be absorbed.
<pre>  <code>
p = Forward3D(mgrid, medium, source_p, sensor_mask, reflection_order);
p = Forward3D(mgrid, medium, source_p, sensor_mask, reflection_order, ...);
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr> 
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the pressure is recorded</td>
  </tr>
   <tr>
   <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr> 
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply non-reflecting layer</td>
  </tr>
   <tr>
  <td>'animation'</td><td>play the animation during the simulation</td>
  </tr>
  <tr>
  <td>'record_animation'</td><td>record the animation</td>
  </tr> 
 </table> 

<br> 
<h3> Details </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 1D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1).
 For homogeneous media, though, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 <br><br>2. The excitation pressure <span style="background-color:#f1f1f1">source_p</span> is indexed as (time, source_position). 
 <br><br>3. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 <br><br>4. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflections to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 <br><br>5. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 <br><br>6. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. A large <span style="background-color:#f1f1f1">medium.NRL_gamma</span> 
 or a small <span style="background-color:#f1f1f1">medium.NRL_alpha</span> implies more energy will be absorbed and 
 thus reducing the aliasing error. On the contrary, if <span style="background-color:#f1f1f1">medium.NRL_alpha</span> is too small, 
 the acoustic filed becomes inaccurate due to excess absorption. 
 <br><br>7. <span style="background-color:#f1f1f1">record_animation</span> will record the animation and save the animation 
 file as ‘animation.avi’.
</p>

<br>  
<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>


<a id="Forward2D_fund"></a>
<h3 style="color: #c64949;">Forward2D_fund</h3>     
<hr>
<p>
 <a href="/mSOUND/function.html#Forward2D_fund">Forward2D_fund</a>
 is a 2D forward simulation function based on the frequency-specific mixed domain method and it
 will generate spatially distributed pressure at the center frequency. Generally, 
 for simulations with small speed of sound or density contrast (contrast ratio less than 1.05), 
 it is unnecessary to apply corrections. The spatial aliasing error can be reduced by increasing the computational domain or applying
 non-reflecting layer to the computational domain. To apply non-reflecting layer to the computational domain, two parameters 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be provided. Setting up a larger <span style="background-color:#f1f1f1">medium.NRL_gamma</span> or
smaller <span style="background-color:#f1f1f1">medium.NRL_alpha</span> 
 means more energy will be absorbed.
<pre>  <code>
p = Forward2D_fund(mgrid, medium, source_p, omega_c, reflection_order);  
p = Forward2D_fund(mgrid, medium, source_p, omega_c, reflection_order, ...);  
</code>  </pre>
</p>

<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium</td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>transducer center frequency [rad]</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply non-reflecting layer</td>
  </tr>
 </table> 

<br> 
<h3> Details </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 1D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y+1).
 For homogeneous media, though, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 <br><br>2. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x, mgrid.num_y+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 <br><br>3. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflections to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 <br><br>4. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 <br><br>5. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. A large <span style="background-color:#f1f1f1">medium.NRL_gamma</span> 
 or a small <span style="background-color:#f1f1f1">medium.NRL_alpha</span> implies more energy will be absorbed and 
 thus reducing the aliasing error. On the contrary, if <span style="background-color:#f1f1f1">medium.NRL_alpha</span> is too small, 
 the acoustic filed becomes inaccurate due to excess absorption. 
</p>


<br>  
<h3>Outputs</h3> 
<p>
Pressure distribution throughout the spatial domain at the center frequency.      
</pr>


<a id="Forward2D_sec"></a>
<h3 style="color: #c64949;">Forward2D_sec</h3>    
<hr>
<p>
 <a href="/mSOUND/function.html#Forward2D_sec">Forward2D_sec</a>
is a 2D forward simulation function based on the frequency-specific mixed domain method and it
 will generate spatially distributed pressure at the second harmonic frequency. 
 To generate the second harmonic pressure field, 
 people must run the function <a href="/mSOUND/function.html#Forward2D_fund">Forward2D_fund</a> first to 
obtain the presure at the center frequency <span style="background-color:#f1f1f1">P_fundamental</span>. 
 When calculating the second harmonic pressure, density heterogeneity is not considered. Generally, 
 for simulations with small speed of sound or density contrast (contrast ratio less than 1.05), 
 it is unnecessary to apply corrections. The spatial aliasing error can be reduced by increasing the computational domain or applying
 non-reflecting layer to the computational domain. To apply non-reflecting layer to the computational domain, two parameters 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be provided. Setting up a larger <span style="background-color:#f1f1f1">medium.NRL_gamma</span> or
smaller <span style="background-color:#f1f1f1">medium.NRL_alpha</span> 
 means more energy will be absorbed.
<pre>  <code>
p = Forward2D_sec(mgrid, medium, P_fundamental, omega_c);  
p = Forward2D_sec(mgrid, medium, P_fundamental, omega_c, ...);  
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>P_fundamental</td><td>pressure at the center frequency  [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>transducer center frequency [rad]</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply non-reflecting layer</td>
  </tr>
 </table> 
<br> 
<h3> Details </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 1D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y+1).
 For homogeneous media, though, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 <br><br>2. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x, mgrid.num_y+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 <br><br>3. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 <br><br>4. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. A large <span style="background-color:#f1f1f1">medium.NRL_gamma</span> 
 or a small <span style="background-color:#f1f1f1">medium.NRL_alpha</span> implies more energy will be absorbed and 
 thus reducing the aliasing error. On the contrary, if <span style="background-color:#f1f1f1">medium.NRL_alpha</span> is too small, 
 the acoustic filed becomes inaccurate due to excess absorption. 
</p>

<br>  
<h3>Outputs</h3> 
<p>
Pressure distribution throughout the spatial domain at the second-harmonic frequency.    
</pr>


<a id="Forward3D_fund"></a>
<h3 style="color: #c64949;">Forward3D_fund</h3>   
<hr>
<p>
<a href="/mSOUND/function.html#Forward3D_fund">Forward3D_fund</a>
is a 3D forward simulation function based on the frequency-specific mixed domain method and it
 will generate spatially distributed pressure at the center frequency. Generally, 
 for simulations with small speed of sound or density contrast (contrast ratio less than 1.05), 
 it is unnecessary to apply corrections. The spatial aliasing error can be reduced by increasing the computational domain or applying
 non-reflecting layer to the computational domain. To apply non-reflecting layer to the computational domain, two parameters 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be provided. Setting up a larger <span style="background-color:#f1f1f1">medium.NRL_gamma</span> or
smaller <span style="background-color:#f1f1f1">medium.NRL_alpha</span> 
 means more energy will be absorbed.
<pre>  <code>
p = Forward3D_fund(mgrid, medium, source_p, omega_c, reflection_order);  
p = Forward3D_fund(mgrid, medium, source_p, omega_c, reflection_order, ...);  
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>transducer center frequency [rad]</td>
  </tr>
 </table> 
<br>
<table>
<tr>
<th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
</tr>
<tr>
<td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
</tr>
   <tr>
  <td>'NRL'</td><td>apply non-reflecting layer</td>
  </tr>
</table> 

<br> 
<h3> Details </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 1D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1).
 For homogeneous media, though, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 <br><br>2. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 <br><br>3. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflections to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 <br><br>4. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 <br><br>5. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. A large <span style="background-color:#f1f1f1">medium.NRL_gamma</span> 
 or a small <span style="background-color:#f1f1f1">medium.NRL_alpha</span> implies more energy will be absorbed and 
 thus reducing the aliasing error. On the contrary, if <span style="background-color:#f1f1f1">medium.NRL_alpha</span> is too small, 
 the acoustic filed becomes inaccurate due to excess absorption. 
</p>

<br>  
<h3>Outputs</h3> 

<p>
Pressure distribution throughout the spatial domain at the center frequency.    
</pr>


<a id="Forward3D_sec"></a>
<h3 style="color: #c64949;">Forward3D_sec</h3>   
<hr>
<p>
<a href="/mSOUND/function.html#Forward3D_sec">Forward3D_sec</a>
 is a 3D forward simulation function based on the frequency-specific mixed domain method and it
 will generate spatially distributed pressure at the second harmonic frequency. 
 To generate the second harmonic pressure field, 
 people must run the function <a href="/mSOUND/function.html#Forward3D_fund">Forward3D_fund</a> first to 
obtain the presure at the center frequency <span style="background-color:#f1f1f1">P_fundamental</span>. 
 When calculating the second harmonic pressure, density heterogeneity is not considered. Generally, 
 for simulations with small speed of sound or density contrast (contrast ratio less than 1.05), 
 it is unnecessary to apply corrections. The spatial aliasing error can be reduced by increasing the computational domain or applying
 non-reflecting layer to the computational domain. To apply non-reflecting layer to the computational domain, two parameters 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be provided. Setting up a larger <span style="background-color:#f1f1f1">medium.NRL_gamma</span> or
smaller <span style="background-color:#f1f1f1">medium.NRL_alpha</span> 
 means more energy will be absorbed.
<pre>  <code>
p = Forward3D_sec(mgrid, medium, P_fundamental, omega_c);   
p = Forward3D_sec(mgrid, medium, P_fundamental, omega_c, ...);   
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>P_fundamental</td><td>pressure at the center frequency  [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>transducer center frequency [rad]</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply non-reflecting layer</td>
  </tr>
 </table> 

<br> 
<h3> Details </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 1D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1).
 For homogeneous media, though, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 <br><br>2. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 <br><br>3. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 <br><br>4. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. A large <span style="background-color:#f1f1f1">medium.NRL_gamma</span> 
 or a small <span style="background-color:#f1f1f1">medium.NRL_alpha</span> implies more energy will be absorbed and 
 thus reducing the aliasing error. On the contrary, if <span style="background-color:#f1f1f1">medium.NRL_alpha</span> is too small, 
 the acoustic filed becomes inaccurate due to excess absorption. 
</p>

<br>  
<h3>Outputs</h3> 
<p>
Pressure distribution throughout the spatial domain at the second-harmonic frequency.    
</pr>


<a id="Backward1D"></a>
<h3 style="color: #c64949;">Backward1D </h3>   
<hr>
<p>
 <a href="/mSOUND/function.html#Backward1D">Backward1D</a>
 is a 1D backward simulation function based on the transient mixed domain method and it will generate transient-domain results.
 Generally, for simulations with small speed of sound or density contrast (contrast ratio less than 1.05), 
 it is unnecessary to apply corrections.
<pre> <code>
p = Backward1D(mgrid, medium, source_p, sensor_mask);  
p = Backward1D(mgrid, medium, source_p, sensor_mask, ...);  
</code>  </pre>
</p>

<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
   <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the pressure is recorded</td>
  </tr>
 </table> 

<br>
<table>
  <tr>
   <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
   <td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
  </tr>
 </table> 


<br>
<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>

<a id="Backward2D"></a>
<h3 style="color: #c64949;">Backward2D  </h3>   
<hr>
<p>
 <a href="/mSOUND/function.html#Backward2D">Backward2D</a>
 is a 2D backward simulation function based on the transient mixed domain method and it will generate transient-domain results.
 Generally, for simulations with small speed of sound or density contrast (contrast ratio less than 1.05), 
 it is unnecessary to apply corrections. The spatial aliasing error can be reduced by increasing the computational domain or applying
 non-reflecting layer to the computational domain. To apply non-reflecting layer to the computational domain, two parameters 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be provided. Setting up a larger <span style="background-color:#f1f1f1">medium.NRL_gamma</span> or
smaller <span style="background-color:#f1f1f1">medium.NRL_alpha</span> 
 means more energy will be absorbed.
 
<pre>  <code>
p = Backward2D(mgrid, medium, source_p, sensor_mask); 
p = Backward2D(mgrid, medium, source_p, sensor_mask, ...); 
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
   <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the pressure is recorded</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply non-reflecting layerr</td>
  </tr>
   <tr>
  <td>'animation'</td><td>play the animation during the simulation</td>
  </tr>
  <tr>
  <td>'record_animation'</td><td>record the animation</td>
  </tr> 
 </table> 
<br>
<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>

<a id="Backward3D"></a>
<h3 style="color: #c64949;">Backward3D</h3>     
<hr>
<p>
 <a href="/mSOUND/function.html#Backward3D">Backward3D</a>
 is a 3D backward simulation function based on the transient mixed domain method and it will generate transient-domain results. 
 Generally, for simulations with small speed of sound or density contrast (contrast ratio less than 1.05), 
 it is unnecessary to apply corrections. The spatial aliasing error can be reduced by increasing the computational domain or applying
 non-reflecting layer to the computational domain. To apply non-reflecting layer to the computational domain, two parameters 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be provided. Setting up a larger <span style="background-color:#f1f1f1">medium.NRL_gamma</span> or
smaller <span style="background-color:#f1f1f1">medium.NRL_alpha</span> 
 means more energy will be absorbed.
<pre>  <code>
p = Backward3D(mgrid, medium, source_p, sensor_mask);
p = Backward3D(mgrid, medium, source_p, sensor_mask, ...);
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr> 
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the pressure is recorded</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
  </tr>
   <tr>
<td>'NRL'</td><td>apply non-reflecting layerr</td>
  </tr>
   <tr>
  <td>'animation'</td><td>play the animation during the simulation</td>
  </tr>
  <tr>
  <td>'record_animation'</td><td>record the animation</td>
  </tr> 
 </table> 
<br>  
<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>

<a id="Backward2D_fund"></a>
<h3 style="color: #c64949;">Backward2D_fund</h3>     
<hr>
<p>
 <a href="/mSOUND/function.html#Backward2D_fund">Backward2D_fund</a>
 is a 2D backward simulation function based on the frequency-specific mixed domain method and it
 will generate spatially distributed pressure at the center frequency. Generally, 
 for simulations with small speed of sound or density contrast (contrast ratio less than 1.05), 
 it is unnecessary to apply corrections. The spatial aliasing error can be reduced by increasing the computational domain or applying
 non-reflecting layer to the computational domain. To apply non-reflecting layer to the computational domain, two parameters 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be provided. Setting up a larger <span style="background-color:#f1f1f1">medium.NRL_gamma</span> or
smaller <span style="background-color:#f1f1f1">medium.NRLalpha</span> 
 means more energy will be absorbed.
<pre>  <code>
p = Backward2D_fund(mgrid, medium, source_p, omega_c);  
p = Backward2D_fund(mgrid, medium, source_p, omega_c, ...);  
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>transducer center frequency [rad]</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply non-reflecting layerr</td>
  </tr>
 </table> 

<br>  
<h3>Outputs</h3> 
<p>
Pressure distribution throughout the spatial domain at the center frequency.      
</pr>

<a id="Backward3D_fund"></a>
<h3 style="color: #c64949;">Backward3D_fund</h3>   
<hr>
<p>
<a href="/mSOUND/function.html#Backward3D_fund">Backward3D_fund</a>
is a 3D backward simulation function based on the frequency-specific mixed domain method and it
 will generate spatially distributed pressure at the center frequency. Generally, 
 for simulations with small speed of sound or density contrast (contrast ratio less than 1.05), 
 it is unnecessary to apply corrections. The spatial aliasing error can be reduced by increasing the computational domain or applying
 non-reflecting layer to the computational domain. To apply non-reflecting layer to the computational domain, two parameters 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be provided. Setting up a larger <span style="background-color:#f1f1f1">medium.NRL_gamma</span> or
smaller <span style="background-color:#f1f1f1">medium.NRL_alpha</span> 
 means more energy will be absorbed.
<pre>  <code>
p = Backward3D_fund(mgrid, medium, source_p, omega_c);  
p = Backward3D_fund(mgrid, medium, source_p, omega_c, ...);  
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the media properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>transducer center frequency [rad]</td>
  </tr>
 </table> 
<br>
<table>
<tr>
<th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
</tr>
<tr>
<td>'correction'</td><td>apply phase and amplitude corrections for strong heterogeneities</td>
</tr>
   <tr>
<td>'NRL'</td><td>apply non-reflecting layerr</td>
  </tr>
</table> 
<br>  
<h3>Outputs</h3> 

<p>
Pressure distribution throughout the spatial domain at the center frequency.    
</pr>


